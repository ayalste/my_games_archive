const gamesData = [
    {
        id: 1,
        name: "עידן ההגנה 3",
        link: "http://mandalamaker.online/games/Age of Defense 3_January_19th_2011.swf",
        type: "flash",
        width: 800,
        height: 500,
        img: "http://www.yo-yoo.co.il/uploads/ageofdef3.png",
        category: "משחקי לחימה ואסטרטגיה" 
    },
    {
        id: 2,
        name: "מלחמת העידנים 2",
        link: "http://www.dailyfreegames.com/gameswf/age-of-war-2-publicOTM3.swf",
        type: "flash",
        width: 720,
        height: 480,
        img: "http://www.yo-yoo.co.il/uploads/ageofwar2_1OTM3.jpg",
        category: "משחקי לחימה ואסטרטגיה" 
    },
    {
        id: 3,
        name: "חרבות ונשמות",
        link: "http://mandalamaker.online/games/Swords and Souls_October_19th_2015.swf",
        type: "flash",
        width: 800,
        height: 600,
        img: "http://www.yo-yoo.co.il/uploads/Swords-and-Souls_October_19th_2015.jpg",
        category: "משחקי לחימה ואסטרטגיה"
    },
    {
        id: 4,
        name: "מתקפת המתוקים",
        link: "http://io-games.io/games/PapaLouie3.swf",
        type: "flash",
        width: 700,
        height: 416,
        img: "http://www.yo-yoo.co.il/uploads/papaloei3.png",
        category: "פה פה לואי"
    },
    {
        id: 5,
        name: "מתקפת האמבורגרים",
        link: "https://files.crazygames.com/papalouie2c.swf",
        type: "flash",
        width: 700,
        height: 461,
        img: "http://www.yo-yoo.co.il/uploads/papapa2.jpg",
        category: "פה פה לואי"
    },
    {
        id: 6,
        name: "אסור ליפול",
        link: "http://www.foddy.net/GetOnTop.swf",
        type: "flash",
        width: 640,
        height: 384,
        img: "http://www.yo-yoo.co.il/uploads/851138-0.jpg",
        category: "לשניים"
    },
    {
        id: 7,
        name: "גלידה רעה",
        link: "http://s3.amazonaws.com/us_nitrome_s3/iframe/badicecream/index.html",
        type: "flash",
        width: 550,
        height: 550,
        img: "http://www.yo-yoo.co.il/uploads/badice1.png",
        category: "לשניים"
    },
    {
        id: 8,
        name: "גשם של סכינים",
        link: "https://play.famobi.com/knife-rain/A-4QBH7",
        type: "iframe",
        width: 800,
        height: 500,
        img: "http://www.yo-yoo.co.il/uploads/KnifeRainTeaser.jpg",
        category: "משחקים נוספים"
    },
    {
        id: 9,
        name: "סנייק יו",
        link: "http://slither.io/",
        type: "iframe",
        width: 750,
        height: 600,
        img: "http://www.yo-yoo.co.il/uploads/sliterrrio.jpg",
        category: "משחקים נוספים"
    },
    {
        id: 10,
        name: "טירוף בעלייה 3",
        link: "http://www8.agame.com/games/flash/u/Uphill_Rush_3/uphill_rush_3.swf",
        type: "flash",
        width: 700,
        height: 520,
        img: "http://www.yo-yoo.co.il/uploads/20101208095913_Uphill-Rush-3.jpg",
        category: "משחקי מרוצים"
    },
    {
        id: 11,
        name: "החווה הגדולה",
        link: "http://media.goodgamestudios.com/games/ranch/",
        type: "iframe",
        width: 800,
        height: 600,
        img: "http://www.yo-yoo.co.il/uploads/goodgame-bigfarm-publishers-thumb.jpg",
        category: "משחקי חווה"
    },
    {
        id: 12,
        name: "סימולטור איש עכביש",
        link: "https://www.gamearter.com/game/amazing-strange-rope-police-vice-spider-vegas/",
        type: "iframe",
        width: 800,
        height: 600,
        img: "http://www.yo-yoo.co.il/uploads/amazing-strange-rope-police-vice-spider-vegas-1.jpg",
        category: "משחקי לחימה ואסטרטגיה"
    },
    {
        id: 13,
        name: "פאקמן סוגר שטחים",
        link: "https://html5.gamedistribution.com/210802df55454737b3ef7f901c0de8d3/",
        type: "iframe",
        width: 800,
        height: 500,
        img: "http://www.yo-yoo.co.il/uploads/pacmansoger1.jpg",
        category: "משחקים נוספים"
    },
    {
        id: 14,
        name: "קורונה וירוס .יו",
        link: "https://html5.gamedistribution.com/7e545f3ea2a54fae961d2a91be659b64/",
        type: "iframe",
        width: 860,
        height: 600,
        img: "http://www.yo-yoo.co.il/uploads/coronaiooo.jpg",
        category: "משחקים נוספים"
    },
    {
        id: 15,
        name: "בן האש ובת המים 5",
        link: "https://html5.gamedistribution.com/03f124074b0049f89fdace0cacf8ead5/",
        type: "iframe",
        width: 800,
        height: 450,
        img: "http://www.yo-yoo.co.il/uploads/waterboymamf5.jpg",
        category: "לשניים"
    },
    {
        id: 16,
        name: "בן האש ובת המים 4",
        link: "https://html5.gamedistribution.com/3790681b69584409b7f681a8e400102d/",
        type: "iframe",
        width: 800,
        height: 510,
        img: "http://www.yo-yoo.co.il/uploads/20130329134248_Fireboy--Watergirl-4-Crystal-Temple.jpg",
        category: "לשניים"
    },
    {
        id: 17,
        name: "בן האש ובת המים 3",
        link: "https://html5.gamedistribution.com/f3a6e1ac0a77412289cbac47658b2b68/",
        type: "iframe",
        width: 900,
        height: 510,
        img: "http://www.yo-yoo.co.il/uploads/f3a6e1ac0a77412289cbac47658b2b68-512x384.jpeg",
        category: "לשניים"
    },
    {
    id: 18,
    name: "בן האש ובת המים 2",
    link: "https://html5.gamedistribution.com/383ad09b92c7446b9113cccc29630517/",
    type: "iframe",
    width: 810,
    height: 459,
    img: "http://www.yo-yoo.co.il/uploads/fireboywarte2.jpg",
    category: "לשניים"
    },
    {
    id: 19,
    name: "בן האש ובת המים 4 מקדש הקרח",
    link: "https://html5.gamedistribution.com/f3a6e1ac0a77412289cbac47658b2b68/",
    type: "iframe",
    width: 800,
    height: 510,
    img: "http://www.yo-yoo.co.il/uploads/icetempleirefboywe.png",
    category: "לשניים"
    },
    {
        id: 20,
        name: "בן האש ובת המים 1",
        link: "https://html5.gamedistribution.com/a55c9cc9c21e4fc683c8c6857f3d0c75/",
        type: "iframe",
        width: 640,
        height: 480,
        img: "http://www.yo-yoo.co.il/uploads/benbat.png",
        category: "לשניים"
    },
    {
        id: 21,
        name: "מלחמת העידנים 1",
        link: "https://html5.gamedistribution.com/9467420d5c84482e9087276338a3a7b1/",
        type: "iframe",
        width: 800,
        height: 500,
        img: "http://www.yo-yoo.co.il/uploads/ageofwarsmallavMzYx.jpg",
        category: "משחקי לחימה ואסטרטגיה"
    },
    {
        id: 22,
        name: "קלאש רויאל ויקינגים",
        link: "http://html5.GameDistribution.com/7fb6eddc884e4a0380f40410134650a3/",
        type: "iframe",
        width: 480,
        height: 640,
        img: "http://www.yo-yoo.co.il/uploads/clashofvikings.png",
        category: "משחקי מלחמה ואסטרטגיה"
    },
    {
        id: 23,
        name: "קולור סוויץ Color Switch",
        link: "https://play.famobi.com/circle-rush/A-4QBH7",
        type: "iframe",
        width: 640,
        height: 640,
        img: "http://www.yo-yoo.co.il/uploads/icon_colorswitch.jpg",
        category: "משחקים נוספים"
    },
    {
        id: 32,
        name: "התנגשות צבעים",
        link: "https://html5.gamedistribution.com/31730d01666641989414fb0c0baccb66/",
        type: "iframe",
        width: 800,
        height: 580,
        img: "http://www.yo-yoo.co.il/uploads/gameballtzbiaom4.jpg",
        category: "משחקים נוספים"
    },
    {
        id: 24,
        name: "Minecraft Classic",
        link: "//classic.minecraft.net/",
        type: "iframe",
        width: 1000,
        height: 600,
        img: "https://d3m9l0v76dty0.cloudfront.net/system/photos/3742656/large/7294d5010b24877f736f0c34eebad166.jpg",
        category: "משחקים נוספים"
    },
    {
        id: 25,
        name: "גולשי רכבת תחתית",
        link: "//games.poki.com/458768/subwaysurfers?tag=pg-v0.165.0&site_id=50&categories=3,4,6,9,96,752,869,952,1103",
        type: "iframe",
        width: 900,
        height: 500,
        img: "https://upload.wikimedia.org/wikipedia/he/d/d3/Subway_Surfers.png",
        category: "משחקים נוספים"
    },
    {
        id: 26,
        name: "ריצה ספרדית",
        link: "http://www.gamezhero.com/get-game-code/346401548fda241720bfad6c7f671255",
        type: "iframe",
        width: 800,
        height: 400,
        img: "http://www.yo-yoo.co.il/uploads/ritza.jpg",
        category: "משחקים נוספים"
    },
    {
        id: 27,
        name: "רוץ ילד רוץ",
        link: "https://games.poki.com/gswitch3",
        type: "iframe",
        width: 832,
        height: 468,
        img: "http://www.yo-yoo.co.il/uploads/g-switch-3.png",
        category: "משחקים נוספים"
    },
    {
        id: 28,
        name: "איש החשמל",
        link: "https://www.crazygames.com/gameframe/electric-man-2-hs",
        type: "iframe",
        width: 752,
        height: 580,
        img: "https://פריב.co.il/wp-content/uploads/thumbs/custom/E/electricman2med1.jpg",
        category: "משחקי לחימה ואסטרטגיה"
    },
    {
        id: 29,
        name: "Doodle God דוגל גוד",
        link: "https://games.poki.com/faeac4d1-b15b-4e82-8f48-c093b6236868?tag=pg-v0.172.0&site_id=50&categories=7,91,96,1146",
        type: "iframe",
        width: 800,
        height: 600,
        img: "https://kizicdn.com/system/static/thumbs/tile_thumb/5191/thumb150_Main_banner_150.jpg?1556203750",
        category: "משחקים נוספים"
    },
    {
        id: 30,
        name: "טירוף בעלייה 4",
        link: "http://www8.agame.com/games/flash/u/UphillRush4/uphill_rush_4.swf",
        type: "object",
        width: 550,
        height: 430,
        img: "http://www.yo-yoo.co.il/uploads/20111206164540_Uphill-Rush-4.jpg",
        category: "משחקי מרוצים"
    },
    {
        id: 31,
        name: "טירוף בעלייה 5",
        link: "http://www8.agame.com/games/flash/u/uphill_rush_5/uphill_rush_5.swf",
        type: "object",
        width: 600,
        height: 450,
        img: "http://www.yo-yoo.co.il/uploads/20121220093858_Uphill-Rush-5.jpg",
        category: "משחקי מרוצים"
    },
    {
        id: 38,
        name: "2048",
        link: "https://html5.gamedistribution.com/23405c5dd9024b5bb5096e22c1fdd5bd/",
        type: "iframe",
        width: 800,
        height: 600,
        img: "http://www.yo-yoo.co.il/uploads/2048-legend.jpg",
        category: "משחקים נוספים"
    },
    {
        id: 33,
        name: "מלחמת מיקרו טנקים",
        link: "https://html5.gamedistribution.com/ad43ea266ab5439aae28319b0a19888b/",
        type: "iframe",
        width: 800,
        height: 600,
        img: "http://www.yo-yoo.co.il/uploads/micro-tank-wars.jpg",
        category: "לשניים"
    },
    {
        id: 34,
        name: "דג אוכל דג 4",
        link: "https://html5.gamedistribution.com/45c4d14eadc14d58a998e2dc6dd6bf5c/",
        type: "iframe",
        width: 768,
        height: 432,
        img: "http://www.yo-yoo.co.il/uploads/fish-eat-fish.jpg",
        category: "לשניים"
    },
    {
        id: 35,
        name: "paper 2",
        link: "//paper-io.com/?mode=paper2",
        type: "iframe",
        width: 640,
        height: 360,
        img: "https://assets.funnygames.org/1/94341/83842/440x280/paperio-2.png",
        category: "משחקים נוספים"
    },
    {
        id: 36,
        name: "hole.io",
        link: "https://hole-io.com/",
        type: "iframe",
        width: 800,
        height: 600,
        img: "https://hole-io.com/images/hole-share.jpg",
        category: "משחקים נוספים"
    },
    {
        id: 37,
        name: "paper minecraft",
        link: "https://www.crazygames.com/gameframe/paper-minecraft?v1",
        type: "iframe",
        width: 800,
        height: 600,
        img: "https://freegamesboom.com/media/upload/game/8d/8dccc51400dae7943510c47d78ea516f.jpg",
        category: "משחקים נוספים"
    }
];

let userNow;
if (localStorage.getItem('user-now') != null) {
    userNow = localStorage.getItem('user-now');
    let userText = `<span>ברוך הבא ${userNow}</span>`;
    document.querySelector('.user-name').innerHTML = userText;
}

let paramsString = window.location.search;
let searchParams = new URLSearchParams(paramsString);

let gameParam = searchParams.get('game');
if (gameParam != null) {
    for(let i in gamesData){
        if(gamesData[i].id == gameParam){
            let imageLink = gamesData[i].link;
            let gameType = gamesData[i].type;
            let gameObject = "";
            let gamewidth = gamesData[i].width;
            let gameheight = gamesData[i].height;
            if(gameType == "flash"){
                gameObject = `<object width="${gamewidth}" height="${gameheight}" id="game-object"><param name="movie" value="${imageLink}">
                <embed src="${imageLink}" type="application/x-shockwave-flash" width="800" height="500"></object>`;  
            }
            if(gameType == "iframe"){
                gameObject = `<iframe width="${gamewidth}" height="${gameheight}" src="${imageLink}"></iframe>`;
            }
            document.getElementById('game-box').innerHTML = gameObject;
            document.getElementById('game-title').innerHTML = gamesData[i].name;
            document.title = gamesData[i].name;
        }
    }
}

let gameCat = searchParams.get('cayegory');
if (gameCat != null) {
    if(gameCat == "כל המשחקים"){
        let linkHtml ='';
        for(let b in gamesData){
            document.title = "כל המשחקים"
            document.getElementById('game-title').innerHTML = "כל המשחקים"
            let gameImg = gamesData[b].img;
            let gameName = gamesData[b].name;
            let id = gamesData[b].id;
            linkHtml += `<a href="games.html?game=${id}" target="_self" class="game" data-id="${id}">
                                <img src="${gameImg}" width="60" height="60">
                            </a>`
            document.getElementById('cat-games').innerHTML = linkHtml;
        }
    }
    else{
        let linkHtml ='';
        for(let b in gamesData){
            if(gamesData[b].category == gameCat){
                document.title = gamesData[b].category;
                document.getElementById('game-title').innerHTML = gamesData[b].category;
                let gameImg = gamesData[b].img;
                let gameName = gamesData[b].name;
                let id = gamesData[b].id;
                linkHtml += `<a href="games.html?game=${id}" target="_self" class="game" data-id="${id}">
                                    <h4>${gameName}</h4>
                                    <img src="${gameImg}" width="160">
                                </a>`
            
            }
            document.getElementById('cat-games').innerHTML = linkHtml;
        }
    }
}



if (localStorage.getItem('game-users') != null && localStorage.getItem('user-now') != 'guest') {
    let usersFavGames = JSON.parse(localStorage.getItem('game-users'));

    const games = document.querySelectorAll('.game');

    for (let i = 0; i < games.length; i++) {
        games[i].addEventListener('click', function(e){
            let thisGameId = Number(this.getAttribute('data-id'));
            //e.preventDefault();
            
            for (let g = 0; g < usersFavGames.length; g++) {
                if(usersFavGames[g][1] == userNow) {
                    usersFavGames[g][2][thisGameId] += 1;
                    localStorage.setItem('game-users', JSON.stringify(usersFavGames));
                    break;
                }
            }
           
            //console.log(usersFavGames);
        })
    }
}
